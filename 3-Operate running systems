3-Operate running systems
Boot, reboot, and shut down a system normally
Boot systems into different targets manually
Interrupt the boot process in order to gain access to a system
Identify CPU/memory intensive processes and kill processes
Adjust process scheduling
Manage tuning profiles
Locate and interpret system log files and journals
Preserve system journals
Start, stop, and check the status of network services
Securely transfer files between systems

BOOT PROCESS
grub bootloader, systemd, POST PROCESS

We lost Root Password
systemctl get-default -> graphical.target
linux....... rd.break
ctrl+x
emergency mode
mount -o remount,rw /sysroot
chroot /sysroot
paaswd Root
touch .autorelabel
mount -o ro,remount /sysroot
exit
if error
then 
linux..... systemd.unit=multi-user.target
login
systemctl get-default -> graphical.target
systemctl set-defaulr multi-user
systemctl get-default -> multi-user.target
this was booting system into different targets manually

SYSTEM LOGGING
exam obj: locate & interrupt system log files & journals
preserve system journals
/var/log
journald
persistant journals

grep -i systemd /var/log/messages | less
grep systemd `find /var/log -maxdepth 1 -type f -print` | grep -v dnf |less
grep -v dnf = exclude dnf entries
shift+g to go to end - g to go to start

journalctl -u httpd
journalctl -g systemd | less (grep for systemd)
journalctl -S 4:25:00 -U 4:26:00
journalctl --list-boots
journalctl SETTINGS - journalctl must be persistant
cat /etc/systemd/journald.conf
#storage=auto  (4 types, volatile /run/log/j, Persistent /var/log/j)
                (NONE all j data dropped, Auto- default - persistent if /var/log/journal exists)
journalctl --flush

INTRUDER ALERT - runaway PROCESS
first step, download STRESS from epel repo
subscription-manager repos --list (copy codeready)
subscription-manager repos --enable codeready-....
yum -y install https://dl.fedoraproject.org/pub/epel/epel-release-latest-9.noarch.rpm
yum install -y STRESS
stress -c 1 &
ps -aux | grep stress
or
ps -ef | grep stress
top
r to renice
kill -9 pid
nice -n 19 stress -c 1 &
renice -n 10 pid
ADJUST PERFORMANCE OF A PROCESS
chrt --max
        SCHED_OTHER min/max priority    : 0/0
        SCHED_FIFO min/max priority     : 1/99
        SCHED_RR min/max priority       : 1/99
        SCHED_BATCH min/max priority    : 0/0
        SCHED_IDLE min/max priority     : 0/0
        SCHED_DEADLINE min/max priority : 0/0
chrt -f -p 45 pid 
pgrep stress
pkill stress


WE ARE ASKED TO HELP TO REDUCE POWER CONSUMPTION IN OUR DATACENTER
tuned-adm
cat /etc/tuned/tuned-main.conf
location for custom profiles
/usr/tuned
/usr/lib/tuned (distro specific profiles)
systemctl start tuned
systemctl enable tuned
tuned-adm active
tuned-adm list profiles
tuned-adm profile powersave
tuned-adm recommend
ENABLE DYNAMIC TUNING
vi /etc/tuned/tuned-main.conf
dynamic_tuning=0 ->1
systemctl restart tuned

systemctl --type=service
systemctl --type=service --state=dead
systemctl --type=service --state=running
systemctl halt
systemctl poweroff

LEGACY SHUTDOWN COMMANDS
[root@x230 ~]# which {shutdown,poweroff,reboot,halt} | xargs ls -l
lrwxrwxrwx. 1 root root 16 Mar 21 00:16 /usr/sbin/halt -> ../bin/systemctl
lrwxrwxrwx. 1 root root 16 Mar 21 00:16 /usr/sbin/poweroff -> ../bin/systemctl
lrwxrwxrwx. 1 root root 16 Mar 21 00:16 /usr/sbin/reboot -> ../bin/systemctl
lrwxrwxrwx. 1 root root 16 Mar 21 00:16 /usr/sbin/shutdown -> ../bin/systemctl
sudo shutdown -r +15 "Please save all work, server is rebooting in 15 minutes"
shutdown -c (to cancel sheduled shutdown)

screen -S Sys-Monitor -t cmdline
DIVIDE CLI into 2
crtl+a |
crtl+a tab
crtl+a c (starts new bash session)
pkill screen
screen -ls
screen -wipe


chrt


LAB - TUNEd 
ls -l /usr/lib/tuned

vimdiff /usr/lib/tuned/virtual-guest/tuned.conf /usr/lib/tuned/virtual-host/tuned.conf
grep -n dynamic_tuning /etc/tuned/tuned-main.conf
=10:dynamic_tuning = 1
vim +10 /etc/tuned/tuned-main.conf
shift+$ r to replace a character
systemctl restart tuned
1028  systemctl start tuned
 1029  systemctl status tuned
 1030  tuned-adm active
 1031  tuned-adm profile
 1032  tuned-adm profile powersave
 1033  tuned-adm active
 1034  tuned-adm profile powersave virtual-guest
 1035  tuned-adm active
[root@x230 ~]# diff /usr/lib/tuned/virtual-guest/tuned.conf /usr/lib/tuned/virtual-host/tuned.conf
6c6
< summary=Optimize for running inside a virtual guest
---
> summary=Optimize for running KVM guests
10,17c10,12
< # If a workload mostly uses anonymous memory and it hits this limit, the entire
< # working set is buffered for I/O, and any more write buffering would require
< # swapping, so it's time to throttle writes until I/O can catch up.  Workloads
< # that mostly use file mappings may be able to use even higher values.
< #
< # The generator of dirty data starts writeback at this percentage (system default
< # is 20%)
< vm.dirty_ratio = 30
---
> # Start background writeback (via writeback threads) at this percentage (system
> # default is 10%)
> vm.dirty_background_ratio = 5
19,22c14,16
< # Filesystem I/O is usually much more efficient than swapping, so try to keep
< # swapping low.  It's usually safe to go even lower than this on systems with
< # server-grade storage.
< vm.swappiness = 30
---
> [cpu]
> # Setting C3 state sleep mode/power savings
> force_latency=cstate.id_no_zero:3|70


SCHEDULER
1005  stress -c 1 &
 1006  chrt --help
 1007  pgrep stress
 1008  chrt -p 29208
 1009  chrt -p 29209
 1010  chrt -r -p 33 29208
 1011  chrt -p 29209
 1012  chrt -r -p 33 29209
 1013  chrt -p 29209
 1014  chrt -r -p 33 29208
 1015  chrt -p 29208
 1016  kill -9 29209
 1017  sudo kill -9 29209
 1018  sudo kill -9 29208
 1019  pgrep stress
 1020  chrt -f 44 stress -c 1 &
 1021  pregep stress
 1022  pgrep stress
 1023  chrt -p 29231

 
 LOG FILES & journals
